<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>PSObjects</title>
  <meta name="description" content="A post about PowerShell objects.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.lukegriffith.co.uk/posts/2016/11/28/PowerShell-PSObjects.html">
  <link rel="alternate" type="application/rss+xml" title="Luke Griffith" href="http://www.lukegriffith.co.uk/feed.xml">

  


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Luke Griffith</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about.html">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">PSObjects</h1>
    <p class="post-meta"><time datetime="2016-11-28T22:00:21+00:00" itemprop="datePublished">Nov 28, 2016</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">luke_griffith</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h1 id="get-member">Get-Member</h1>
<p>Everything in PowerShell returns an object. It may be an object of the  System.String class, it may be an object of the System.Management.Automation.PSDriveInfo class literally everything returned in the shell is an object, with properties, methods and so much more!</p>

<p>The best way to work out what you’re looking at is the cmdlet Get-Member. Pipe anything to this and it will return not only what type of object you have but also its members and properties.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_1.gif" alt="get-member" /></p>

<p>Above I’ve piped the command Get-Process what returns an object of the class  System.Diagnostics.Process, what is a list of running processes on the system . This shows its properties, and methods. One method of this Object is .Kill(), running this method against an objcet of this type would kill the process.</p>

<h1 id="objects-through-the-pipeline">Objects through the Pipeline</h1>
<p>As I mentioned previously, you can use the pipe to pass objects to another cmdlet, you can also enumerate object in the pipe with Where/ForEach-Object, and within a script block the pipeline object is represented as the variable $_. Passing objects through the pipeline allows you to manipulate them. In the below example, I’ve used the select-object cmdlet.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_2.gif" alt="select-object" /></p>

<p>So in this case, the get-service cmdlet is being presented to the shell as an object then I’m selecting the ServiceName and the first object in the collection (This is the first object in the array of objects returned from get-service).</p>

<p>As you can see with the Select-Object cmdlet, you need to specify the property to view, you can add multiple ones by adding a comma or you can try and add a wildstar * and it will return every single property the object has. In most cases, there are too many and a lot of them are unnecessary so the shell redacts them but a lot of them can be helpful in specific cases. This is controlled through cmdlet XML formatting.</p>

<h1 id="hashtables">HashTables</h1>
<p>Hashtables are a type of object in PowerShell used to move, store and transform data. Cmdlets of similar names, like Get-Service and Stop-Service accept the same parameters some of these can be accessed via the pipeline, so piping Get-Service to Stop-Service it automatically knows that the Name passed from Get-Service will be used was the Name for Stop-Service. In some cases, the pipeline parameters the cmdlet accepts will be different from the object that you’re piping, The below example shows importing a CSV file of stopped services, and transforming the name to be piped into Get-Service, then eventually Stop-Service. In this case a hashtable would need to be used on the Select-Object cmdlet to change the name of the property. Below I’ve changed ServiceName to Name, I can tell the Name property takes input by pipeline as I’ve checked it using the Get-Help cmdlet.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_3.gif" alt="transformexample" /></p>

<p>Creating a longer pipe, using the ` charater to indicate to the shell to ignore the line break.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_4.gif" alt="pipeline" /></p>

<p>Hashtables are also used as key value stores, for instance you can store strings, numbers and any object using a key, then obtain it from the hashtable using the key.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_5.gif" alt="hashtable" /></p>

<h1 id="formatting">Formatting</h1>
<p>Each cmdlet and PowerShell object generally gets formatted in different ways depending on what information is returned. You can bypass this and manually tell the Shell to format it in your desired way.</p>

<p>Format-List and Format-Table can be used for this, see the below example.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_6.gif" alt="format-table" /></p>

<h1 id="methods-and-properties">Methods and Properties</h1>
<p>In this example, I will run the .Kill() method against Notepad.exe, in a practical example I would pipe the output of my first command to Stop-Process but I want to show how PowerShell Methods and Properties can be used.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_7.gif" alt="methods" /></p>

<p>I’ve done a few new things in the above example, first off I’ve used the Where-Object cmdlet, this cmdlet give you the ability to map an expression to each of the pipeline objects, in case the cmdlet does not support filtering (Always best to filter as far left of the pipe as possible). The syntax is a bit different and requires script blocks { } to process the object. In the above example i’ve expressed where the objects ProcessName is equal to Notepad it will keep the object, and the rest will be thrown away. The $_ represents the object in the pipeline, so the PowerShell object passed through from Get-Process is represented as $_ the .ProcessName is a member property of the Get-Process object, this can be found using the Get-Member cmdlet.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_8.gif" alt="where-object" /></p>

<p>You will also notice the $notepadProcess syntax I used. This stores the object of the get-process cmdlet to the variable $notepadProcess, this gives me the ability to come back to it later, or more easily run methods on the object like the .Kill method. All variables in PowerShell start with a dollar sign $ and you can set anything to them, an integer, string, powershell object… anything.</p>

<p>You can also pull back individual properties as well as methods.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_9.gif" alt="where-object" /></p>

<h1 id="creating-objects">Creating Objects</h1>
<p>Objects can be created and returned to the shell by using a type accelerator, and a hashtable or dictionary object. Say I made a query and want to take some properties and add them to my own, You can store the output and define them In your own object to be used later.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="cm">&lt;#
.notes
Script gives an example of how to generate a PowerShell object from script level variables
 
.output
ComputerName 10.0.0.20
------------ ---------
HostA        10.0.0.20
 
#&gt;</span>
 
<span class="nv">$ComputerName</span> <span class="o">=</span> <span class="s2">"HostA"</span>
<span class="nv">$IPAddress</span> <span class="o">=</span> <span class="s2">"10.0.0.20"</span>
 
<span class="nv">$object</span> <span class="o">=</span> <span class="o">[</span>pscustomobject]@<span class="o">{</span>

ComputerName <span class="o">=</span> <span class="s2">"HostA"</span>
<span class="nv">$IPAddress</span> <span class="o">=</span> <span class="s2">"10.0.0.20"</span>

<span class="o">}</span>
 
<span class="nv">$object</span></code></pre></figure>

<h1 id="psobject-property">.PsObject property</h1>
<p>The .PsObject property contains meta data about the object its self. Any object can be accessed directly on this property, and it exposes members, properties, methods and details about its base object. Type names are also included.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/psobj_9.gif" alt="psobject" /></p>

  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Luke Griffith</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Luke Griffith</li>
          <li><a href="mailto:lukemgriffith@gmail.com">lukemgriffith@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/lukemgriffith"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">lukemgriffith</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/LukeGriffith"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">LukeGriffith</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Luke's place to talk about work and studies.
</p>
      </div>
    </div>




  </div>

</footer>


  </body>

</html>
