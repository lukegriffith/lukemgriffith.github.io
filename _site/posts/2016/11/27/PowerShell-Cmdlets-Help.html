<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>PowerShell, Cmdlets &amp; Help</title>
  <meta name="description" content="What is PowerShell, and an introduction to Cmdlets and the help system.">

  <link rel="stylesheet" href="/css/main.css">
  <link rel="canonical" href="http://www.lukegriffith.co.uk/posts/2016/11/27/PowerShell-Cmdlets-Help.html">
  <link rel="alternate" type="application/rss+xml" title="Luke Griffith" href="http://www.lukegriffith.co.uk/feed.xml">

  


</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Luke Griffith</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about.html">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title" itemprop="name headline">PowerShell, Cmdlets & Help</h1>
    <p class="post-meta"><time datetime="2016-11-27T20:00:21+00:00" itemprop="datePublished">Nov 27, 2016</time> • <span itemprop="author" itemscope itemtype="http://schema.org/Person"><span itemprop="name">luke_griffith</span></span></p>
  </header>

  <div class="post-content" itemprop="articleBody">
    <h1 id="what-is-powershell">What is PowerShell?</h1>

<p>PowerShell is an Automation and Management Framework intended to replace Windows Command Line and VBScript, the Monad Manifesto originally created by Jeffrey Snowver what laid the road map for PowerShell wanted to bring together, a consistent set of tools that can aid in windows (and now cross-platform) infrastructure and application automation that can help ease not only management of the entire environment but to also allow for a quicker pace of development of automation and tools. Along with this, the framework Desire State Configuration first shown off in version 4 brings the ability for true automation for Windows, allowing for tools similar to Puppet, Chef and Ansible to deploy Windows environments with the same ease and extensibility that UNIX and Linux operating systems have had for years.</p>

<p>The old style of Windows management is changing, in the near future configuration of the windows OS will come down to intelligently modifying text files. Although this is a game changers for most this is the next stage of OS management and is required as more of our core systems migrate to the cloud.</p>

<h1 id="where-to-start">Where to start?</h1>

<h2 id="powershellexe-or-powershelliseexe">Powershell.exe or Powershell_ISE.exe?</h2>
<p>The ISE (Integrated Scripting Environment) is a tool provided by microsoft it is a full development environment for powershell scripts. This tool highlights syntax issues, and can guide you on creating scripts. This can be launched by typing ISE into powershell. 
 
Powershell.exe - This is the core shell, the application that takes what input you’ve given it and runs back to the server/workstation to obtain the information, or runs the configuration cmdlets you’ve sent. Most configuration commands do require the shell to be run in Administrative mode, the mode can be determined by the window title (it will start with Administrator if it is).</p>

<h2 id="what-version-of-powershell-am-i-running">What version of PowerShell am I running?</h2>
<p>Theres a built in environment variable with powershell called $PSversiontable. This will return the version of powershell thats currently installed on your system. I recommend upgrading to the most current up to date stable version PowerShell V4. There is a beta of V5 for windows 8 and 8.1 but this is still unstable. Upgrading the Windows Management Framework will upgrade powershell.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/clip_image002.gif" alt="PSVersion" /></p>

<h1 id="cmdlets--help-system">Cmdlets / help system</h1>

<h3 id="cmdlets">Cmdlets</h3>

<p>Powershell runs on Cmdlets, and all Microsoft products (and as a recommended standard so do its partners) uses verb-and-noun pairs to name them. This is why you will see things like.
 </p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nb">Get-Service
Stop-Service
Start-Service
Set-Service</span></code></pre></figure>

<p> 
This convention makes understanding what PowerShell cmdlets do so easy, and from a glance you can probably guess what the above 4 all do. Along with making it easy to understand what they do, it also makes it easy to search for related cmdlets and finding out what ones get information, or make changes to the system.
### Anatomy of the a cmdlet
The below example shows a full cmdlet with parameters and parameter values 
<img src="http://www.lukegriffith.co.uk/images/psintro/clip_image003.gif" alt="Anatomty" /></p>

<p>The position of the parameters are important, and generally with the first parameters you can drop the parameter name, so in this case Get-EventLog Security would guy also work.</p>

<h3 id="finding-cmdlets">Finding Cmdlets</h3>
<p>PoSH comes with another invaluable command that I use daily, get-command. The command on its own pulls back a full list of loaded commands, but if you interrogate the help documentation you can use the cmdlets parameters to filter down the results.
<img src="http://www.lukegriffith.co.uk/images/psintro/clip_image004.gif" alt="Anatomty" /></p>

<p>The above example, pulls back a cmdlet we’ve already seen get-service, but the -verb parameter can be used on its own to pull back a full list of get, set, start, or any other verb that PowerShell uses. You can also use wildcards in your search as in the below example.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/clip_image006.gif" alt="Get-Command" /></p>

<h3 id="the-help-system">The Help System</h3>

<p>Powershells help system is extensive, and unlike other windows products the help system is separate to the core application what means its updated all the time by Microsoft and can be updated live without patches or upgrading occurring.</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell">Update-Help</code></pre></figure>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/clip_image006.gif" alt="Update-Help" /></p>

<p>Running the Update-Help cmdlet, will download the latest version of help documentation from the web, the green progress bar will appear and pause the shell until the operation has completed. 
 </p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nb">Get-Help</span> &lt;Cmdlet&gt;</code></pre></figure>

<p>Using the help system is simple, the cmdlet you need more information on, just type get-help with the cmdlet and it will pull back the documentation. If you’re unable or unwilling to update the help, for whatever reason, you can use a -online switch that launches the default web browser to the relevant msdn page that contains the same information.
 
There are also other switches, like -examples, and -full. Examples presents samples of the cmdlet being used, and full gives you the full documentation, parameters and all.</p>

<p><img src="http://www.lukegriffith.co.uk/images/psintro/clip_image010.gif" alt="Update-Help" /></p>

<p>The object can look a bit daunting, loads of square brackets and and dashes everywhere but the examples, and documentation it gives out is invaluable and second to none to any other scripting languages I’ve used.</p>

<h3 id="alaises">Alaises</h3>

<p>As with cmd, and bash PowerShell has the ability to alias commands, you can use the get-alias command to see a full list, or you can use new-alias to create your own. For the base of this document I will not use aliases as its good practice when writing production scripts to use full names, but you can feel free to explore this yourself some examples from my personal shell profile</p>

<figure class="highlight"><pre><code class="language-powershell" data-lang="powershell"><span class="nb">new-alias</span> -name vim -value <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\V</span><span class="s2">im</span><span class="se">\v</span><span class="s2">im74</span><span class="se">\v</span><span class="s2">im.exe"</span>
<span class="nb">new-alias</span> -name wm -value <span class="s2">"whatmask.exe"</span>
<span class="nb">new-alias</span> -name netbrain -value <span class="s2">"C:</span><span class="se">\P</span><span class="s2">rogram Files (x86)</span><span class="se">\N</span><span class="s2">etBrain</span><span class="se">\W</span><span class="s2">orkstation Operator Edition</span><span class="se">\b</span><span class="s2">in</span><span class="se">\N</span><span class="s2">etBrainWorkbench.exe"</span>
<span class="nb">new-alias</span> -name RepPro -value <span class="s2">"Scr:</span><span class="se">\S</span><span class="s2">cripts</span><span class="se">\R</span><span class="s2">epProWk.ps1"</span></code></pre></figure>

<p>Other default aliases already configure are gps (get-process) ls/dir/gci (get-childitem)</p>


  </div>

</article>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Luke Griffith</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li>Luke Griffith</li>
          <li><a href="mailto:lukemgriffith@gmail.com">lukemgriffith@gmail.com</a></li>
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/lukemgriffith"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">lukemgriffith</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/LukeGriffith"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">LukeGriffith</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Luke's place to talk about work and studies.
</p>
      </div>
    </div>




  </div>

</footer>


  </body>

</html>
